if (self.CavalryLogger) { CavalryLogger.start_js(["1tEPu"]); }

__d("PagesMessageSender",["MercuryMessageActions","MercuryMessageObject","MercurySourceType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e){this.__senderID=a,this.__threadID=c,this.__messageActions=b("MercuryMessageActions").getForFBID(a),this.__messageObject=b("MercuryMessageObject").getForFBID(a),this.__creatorInfo=e?e:null,this.__pageID=d}a.prototype.__willSendMessage=function(a){};a.prototype.getTargetThreadID=function(){return this.__threadID};a.prototype.sendMessage=function(a){this.__willSendMessage(a);a=this.__messageObject.constructUserGeneratedMessageObject(a,b("MercurySourceType").TITAN_WEB,this.__threadID,null,this.__creatorInfo);this.__messageActions.send(a)};e.exports=a}),null);
__d("PagePluginMessageSender",["PagePluginEvents","PagePluginLogger","PluginPageTabKey","PagesMessageSender"],(function(a,b,c,d,e,f){"use strict";var g;c=babelHelpers.inherits(a,b("PagesMessageSender"));g=c&&c.prototype;function a(a,c,d,e){g.constructor.call(this,a,c,d,null),this.$PagePluginMessageSender1=new(b("PagePluginLogger"))(d,e)}a.prototype.__willSendMessage=function(a){this.$PagePluginMessageSender1.notify(b("PagePluginEvents").page_plugin.messages.send,b("PluginPageTabKey").MESSAGES,{message:a})};e.exports=a}),null);
__d("PluginSentryState",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({VALID:0,CONFIRMATION_REQUIRED:1,ERROR:2})}),null);
__d("XPluginPageMessagesTabSentryConfirmActionController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/confirm/page/messages/action/",{})}),null);
__d("XPluginPageMessagesTabSentryController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/page/messages/confirm/",{})}),null);
__d("XPluginPageMessagesTabSentryPopupPluginController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/confirm/page/messages/send/",{page_id:{type:"String",required:!0},message:{type:"String",required:!0},thread_id:{type:"String",required:!0},iframe_referer:{type:"String",defaultValue:""}})}),null);
__d("PagePluginMessagesTab.react",["cx","fbt","ix","AbstractTextArea.react","AsyncRequest","BanzaiODS","Image.react","Keys","Layout.react","Link.react","PagePluginEvents","PagePluginLogger","PagePluginMessageSender","PluginPageTabKey","PluginSentryState","PopupWindow","React","ReactDOM","ShimButton.react","Vector","XPluginPageMessagesTabSentryConfirmActionController","XPluginPageMessagesTabSentryController","XPluginPageMessagesTabSentryPopupPluginController","XUIButton.react","XUISpinner.react"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("Layout.react").Column,l=b("Layout.react").FillColumn;c=babelHelpers.inherits(a,b("React").Component);j=c&&c.prototype;function a(a,c){j.constructor.call(this,a,c),this.$1=new(b("PagePluginLogger"))(this.props.pageID,this.props.refererURI),this.$2=new(b("PagePluginMessageSender"))(this.props.userID,this.props.threadID,this.props.pageID,this.props.refererURI),this.state={shouldShowMessageSentView:!1,isSentryPending:!1,isWaitingForUserConfirmation:!1,isSentryError:!1,message:"",bottomPartHeight:0}}a.prototype.componentDidMount=function(){this.$1.notify(b("PagePluginEvents").page_plugin.tab.render,b("PluginPageTabKey").MESSAGES),this.setState({bottomPartHeight:this.$3()})};a.prototype.$3=function(){var a=this.refs.bottomRoot;if(!a)return 0;a=b("ReactDOM").findDOMNode(a);return!a?0:b("Vector").getElementDimensions(a).y};a.prototype.$4=function(){var a=this.state.message;window.notifySentryConfirm=function(){this.$5(a),window.notifySentryConfirm=undefined}.bind(this);var c=b("XPluginPageMessagesTabSentryPopupPluginController").getURIBuilder().setString("page_id",this.props.pageID).setString("message",this.state.message).setString("thread_id",this.props.threadID).setString("iframe_referer",this.props.refererURI).getURI();b("PopupWindow").open(c,270,450)};a.prototype.$6=function(){b("BanzaiODS").bumpEntityKey("messenger_commerce","page_plugin.check_sentry");this.setState({isSentryPending:!0});var a=b("XPluginPageMessagesTabSentryController").getURIBuilder().getURI();new(b("AsyncRequest"))().setURI(a).setMethod("POST").setData({page_id:this.props.pageID,message:this.state.message,iframe_referer:this.props.refererURI}).setHandler(function(a){a=a.payload;a.result===b("PluginSentryState").CONFIRMATION_REQUIRED?this.$7():a.result===b("PluginSentryState").VALID?this.$8():this.$9()}.bind(this)).setErrorHandler(function(){this.$9()}.bind(this)).send()};a.prototype.$8=function(){this.setState({isSentryPending:!1}),this.$10()};a.prototype.$10=function(){b("BanzaiODS").bumpEntityKey("messenger_commerce","page_plugin.send_message"),this.$2.sendMessage(this.state.message),this.setState({message:"",shouldShowMessageSentView:!0})};a.prototype.$7=function(){this.setState({isWaitingForUserConfirmation:!0,isSentryPending:!1})};a.prototype.$9=function(){this.setState({isSentryPending:!1,isSentryError:!0})};a.prototype.$5=function(a){this.setState({isWaitingForUserConfirmation:!1,isSentryPending:!1,message:"",shouldShowMessageSentView:!0});var c=b("XPluginPageMessagesTabSentryConfirmActionController").getURIBuilder().getURI();new(b("AsyncRequest"))().setURI(c).setMethod("POST").setData({page_id:this.props.pageID,message:a,iframe_referer:this.props.refererURI}).send()};a.prototype.$11=function(){var a=h._("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u00ab{page_name}\u00bb...",[h._param("page_name",this.props.pageName)]);return b("React").createElement("div",{className:"_2p5m",style:{bottom:this.state.bottomPartHeight+"px"}},b("React").createElement(b("AbstractTextArea.react"),{disabled:this.state.isSentryPending||this.state.isWaitingForUserConfirmation||this.state.isSentryError,onChange:function(event){return this.setState({message:event.target.value})}.bind(this),placeholder:a,value:this.state.message}))};a.prototype.$12=function(){return b("React").createElement(b("XUIButton.react"),{className:"_2p5n",size:"large",label:h._("\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0435\u0449\u0435 \u043e\u0434\u043d\u043e"),onClick:function(){return this.setState({shouldShowMessageSentView:!1})}.bind(this)})};a.prototype.$13=function(){return b("React").createElement(b("Image.react"),{className:"_387u",src:i("30160"),width:24})};a.prototype.$14=function(){return b("React").createElement("div",{className:"_1lhb"},this.$13(),b("React").createElement("div",{className:"_2wni"},h._("\u041e\u0448\u0438\u0431\u043a\u0430")))};a.prototype.$15=function(){return b("React").createElement(b("ShimButton.react"),{className:"_1lhb _2wnh",onClick:function(){return this.$4()}.bind(this)},this.$13(),b("React").createElement("div",{className:"_2wni"},h._("\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c")))};a.prototype.$16=function(){return b("React").createElement(b("XUIButton.react"),{className:"_2p5n",size:"large",use:"confirm",label:h._("\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),onClick:function(){return this.$6()}.bind(this),disabled:this.state.isSentryPending||this.state.message.trim()==="",image:this.state.isSentryPending?b("React").createElement(b("XUISpinner.react"),null):null})};a.prototype.$17=function(){var a=null;this.state.shouldShowMessageSentView?a=this.$12():this.state.isSentryError?a=this.$14():this.state.isWaitingForUserConfirmation?a=this.$15():a=this.$16();return b("React").createElement(b("Layout.react"),{className:"_2p5v"},b("React").createElement(l,{className:"_5rto"},this.props.responsiveness),b("React").createElement(k,null,a))};a.prototype.$18=function(){return b("React").createElement(b("Layout.react"),{className:"_2p5w"},b("React").createElement(k,null,b("React").createElement(b("Image.react"),{className:"_2p5x",src:i("95074"),width:"28"})),b("React").createElement(l,null,b("React").createElement("div",{className:"_2p5y"},h._("\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f, \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u00ab{page-name}\u00bb, \u0438 \u043e\u0442\u0432\u0435\u0442\u044b \u043d\u0430 \u043d\u0438\u0445 \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0432 Messenger",[h._param("page-name",b("React").createElement("span",null,this.props.pageName))]))))};a.prototype.$19=function(){var a=b("React").createElement("div",{className:"_2p5z"},b("React").createElement(b("Image.react"),{className:"_2p5-",src:i("28210"),width:32}),b("React").createElement("div",{className:"_2p5_"},h._("\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e")),b("React").createElement("div",{className:"_2p60"},h._("\u0412\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0431\u044b\u043b\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e. \u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 Messenger \u0441 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u0433\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043f\u043e \u0441\u0441\u044b\u043b\u043a\u0435 {messenger_url}, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u043a\u0443.",[h._param("messenger_url",b("React").createElement(b("Link.react"),{href:"https://messenger.com",target:"_blank"},"messenger.com"))])));return b("React").createElement("div",{className:"_1_c3"},b("React").createElement("div",{className:"_2p61"},b("React").createElement("div",{className:"_2p62"},a)),b("React").createElement("div",{className:"_2p63"},this.$17()))};a.prototype.$20=function(){return b("React").createElement("div",{className:"_1_c3"},this.$11(),b("React").createElement("div",{className:"_2p63",ref:"bottomRoot"},this.$18(),this.$17()))};a.prototype.render=function(){if(this.state.shouldShowMessageSentView)return this.$19();else return this.$20()};e.exports=a}),null);